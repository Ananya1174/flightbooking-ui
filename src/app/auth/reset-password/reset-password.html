<div class="auth-page">

  <div class="auth-card">

    <h2>Reset Password</h2>

    <form [formGroup]="form" (ngSubmit)="submit()">

      <label>New Password</label>
      <input
        type="password"
        formControlName="newPassword"
        placeholder="Enter new password"
      />

      <div class="password-rules">
        <p [class.valid]="passwordStatus.length">
          ✓ Minimum 12 characters
        </p>
        <p [class.valid]="passwordStatus.uppercase">
          ✓ One uppercase letter
        </p>
        <p [class.valid]="passwordStatus.lowercase">
          ✓ One lowercase letter
        </p>
        <p [class.valid]="passwordStatus.number">
          ✓ One number
        </p>
        <p [class.valid]="passwordStatus.special">
          ✓ One special character
        </p>
      </div>

      <label>Confirm New Password</label>
      <input
        type="password"
        formControlName="confirmNewPassword"
        placeholder="Re-enter new password"
      />

      <small class="error"
        *ngIf="form.touched && !passwordsMatch()">
        Passwords do not match
      </small>

      <button
        type="submit"
        [disabled]="
          loading ||
          !form.valid ||
          !passwordStatus.valid ||
          !passwordsMatch()
        "
      >
        {{ loading ? 'Resetting...' : 'Reset Password' }}
      </button>

    </form>

    <p class="message" *ngIf="message">{{ message }}</p>

  </div>

</div>