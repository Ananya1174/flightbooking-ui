<div class="booking-page" *ngIf="flight">
  <div class="flight-summary">
    <div>
      <h2>{{ flight.airlineName }}</h2>
      <p>{{ flight.origin }} â†’ {{ flight.destination }}</p>
    </div>
    <div class="price">
      â‚¹{{ flight.price }} <span>/ seat</span>
    </div>
  </div>

  <div class="booking-layout">
    <section class="seat-section">
      <app-seat-map [flightId]="flightId" [maxSelectableSeats]="bookingForm.get('numSeats')?.value"
        (seatsSelected)="onSeatsSelected($event)">
      </app-seat-map>
    </section>
    <section class="passenger-section">

      <form [formGroup]="bookingForm">

        <label class="seat-count">
          Passengers
          <input type="number" formControlName="numSeats" min="1" (change)="onSeatCountChange()" />
        </label>

        <div formArrayName="passengers" *ngFor="let p of passengers.controls; let i = index">

          <div [formGroupName]="i" class="passenger-card">

            <div class="passenger-header">
              <h4>Passenger {{ i + 1 }}</h4>
              <span class="seat-badge">
                Seat {{ p.value.seatNumber || 'â€”' }}
              </span>
            </div>

            <input placeholder="Name" formControlName="name" />
            <input type="number" placeholder="Age" formControlName="age" />

            <select formControlName="gender">
              <option value="">Gender</option>
              <option value="M">Male</option>
              <option value="F">Female</option>
            </select>

            <select formControlName="mealPreference">
              <option value="">Meal Preference</option>
              <option value="VEG">VEG</option>
              <option value="NON_VEG">NON VEG</option>
            </select>

          </div>
        </div>

        <button type="button" class="confirm-btn" (click)="confirmBooking()" [disabled]="isConfirmDisabled()">
          {{ loading ? 'Booking...' : 'Confirm Booking' }}
        </button>

      </form>
      <p class="error" *ngIf="errorMessage">{{ errorMessage }}</p>

      <div *ngIf="bookingResponse" class="booking-success">
        <h3>ðŸŽ‰ Booking Confirmed</h3>

        <div class="success-row">
          <span>PNR</span>
          <strong>{{ bookingResponse.pnr }}</strong>
        </div>

        <div class="success-row">
          <span>Status</span>
          <strong>{{ bookingResponse.status }}</strong>
        </div>

        <div class="success-row">
          <span>Total Paid</span>
          <strong>â‚¹{{ bookingResponse.totalPrice }}</strong>
        </div>
      </div>

    </section>
  </div>
</div>